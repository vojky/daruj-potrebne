<!doctype html>
<html lang="cs">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Pro Ukrajinu">
  <meta name="author" content="">
  <title>Pro Ukrajinu ¬∑ daruj pot≈ôebn√©</title>
  <link rel="icon" type="image/svg+xml" href="https://cdn.jsdelivr.net/gh/bbscout/daruj-potrebne@main/img/favicon.svg">
  <link rel="alternate icon" href="https://cdn.jsdelivr.net/gh/bbscout/daruj-potrebne@main/img/favicon.ico">
  <link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/bbscout/daruj-potrebne@main/img/favicon.svg" color="#ff8a01">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/gh/bbscout/daruj-potrebne@main/css/style.css" rel="stylesheet">
  <style>
    .form-control.no-validate:valid {
      border-color: #ced4da;
      padding-right: .75rem;
      background: none;
    }
  </style>
</head>

<body class="bg-light">
  <script>
    //Definice funkce
    function msieversion() {

      var ua = window.navigator.userAgent;
      var msie = ua.indexOf("MSIE ");

      if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))  // Pokud jde o IE
      {
        alert("Pou≈æ√≠v√°te nepodporovan√Ω prohl√≠≈æeƒç. Pros√≠me, pou≈æijte Google Chrome, Mozilla Firefox, Microsoft Edge apod."); //
      }


      return false;
    }

    msieversion(); //Spust√≠ funkci
  </script>
  <div class="container">
    <main>
      <div class=" col-md-10 offset-md-1 mb-3 text-center">
        <img src="https://cdn.jsdelivr.net/gh/bbscout/daruj-potrebne@main/img/pozadi-ukrajina.jpg" class="img-fluid"
          alt="sn√≠mek vyti≈°tƒõn√© metodiky">
        <h1><a href="index.html">Pro Ukrajinu</a></h1>
        <h2>Nebojte si ≈ô√≠ct o pomoc, nebo darujte konkr√©tn√≠ vƒõci, kter√© nƒõkdo pot≈ôebuje...</h2><br>
        <p class="mb-3">
          Jste v nouzi a pot≈ôebujete pomoct? Utekli jste p≈ôed v√°leƒçn√Ωm konfliktem a chyb√≠ v√°m obleƒçen√≠, vybaven√≠
          dom√°cnosti nebo jin√© za≈ô√≠zen√≠?
          Nebojte se ≈ô√≠ct si o pomoc. Jsme tu od toho, abychom v√°m ji zprost≈ôedkovali. A nemus√≠ j√≠t ani o maliƒçkosti.
          Nƒõkdo r√°d daruje pou≈æit√Ω mobil,
          jin√Ω zase koup√≠ plenky pro miminko. Staƒç√≠ vyplnit formul√°≈ô na z√°lo≈æce Pot≈ôebuji pomoc a my v√°m j√≠ zkus√≠me
          naj√≠t. Jsme tu proto, abychom si pom√°hali.
        </p>
        <p class="mb-3">
          Chcete darovat, ale nev√≠te co je pot≈ôeba? Pod√≠vejte se n√≠≈æe... N√°≈° syst√©m funguje na z√°kladƒõ popt√°vky a
          nab√≠dky. Popt√°van√© vƒõci najdete
          na z√°lo≈æce nab√≠z√≠m pomoc. P≈ôe≈°krtnut√© polo≈æky u≈æ nƒõkdo nab√≠dl, ale zat√≠m jsme je nep≈ôedali. M≈Ø≈æete je klidnƒõ
          za≈°krtnout tak√© a zv√Ω≈°it ≈°anci,
          ≈æe dan√° vƒõc skuteƒçnƒõ napln√≠ oƒçek√°v√°n√≠.
        </p>
        <p>

          <a data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false"
            aria-controls="collapseExample" class="link-secondary"> v√≠ce o projektu</a>
        </p>
      </div>
      <div class=" col-md-10 offset-md-1 text-center">
        <div class="collapse " id="collapseExample">
          <div class="card card-body mb-5">
            <p class="text-left mb-0"><small>
                Kdy≈æ jsme se rozhodovali, jak se zapojit do pomoci Ukrajinƒõ, tak byla materi√°ln√≠ sb√≠rka jedn√≠m z prvn√≠ch n√°pad≈Ø. Jen≈æe takov√° sb√≠rka je
                jednak logisticky velmi n√°roƒçn√° a jednak ƒçasto pom≈Ø≈æe lidem v dobr√© v√≠≈ôe darovat vƒõci, kter√© u≈æ nechtƒõj√≠, ale kter√© taky nikomu nepomohou.
                Na≈°√≠m c√≠lem bylo vytvo≈ôit sb√≠rku, kter√° c√≠lenƒõ pom≈Ø≈æe lidem v nouzi naj√≠t to, co skuteƒçnƒõ pot≈ôebuj√≠. 
              </small></p>
            <p class="text-left mb-0"><small>
                Pojƒème to spoleƒçnƒõ zkusit üíó.
              </small></p>
          </div>
        </div>
      </div>



      <div class="col-md-10 offset-md-1 ">

        <nav>
          <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
            <button class="nav-link text-xs-center active" id="nav-potrebuji-tab" data-bs-toggle="tab"
              data-bs-target="#nav-potrebuji" type="button" role="tab" aria-controls="nav-potrebuji"
              aria-selected="true"><i class="bi bi-question"></i> Pot≈ôebuji pomoc</button>
            <button class="nav-link text-xs-center" id="nav-nabizim-tab" data-bs-toggle="tab"
              data-bs-target="#nav-nabizim" style="margin-right: 1px;" type="button" role="tab"
              aria-controls="nav-nabizim" aria-selected="false"><i class="bi bi-gift"></i> Nab√≠z√≠m pomoc</button>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div class="m-3 tab-pane fade show active" id="nav-potrebuji" role="tabpanel"
            aria-labelledby="nav-potrebuji-tab">

            <form class="needs-validation" id="requests-form">
              <div class="row ">
                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="Jm√©no" class="form-label"><i class="bi bi-person"></i> Jm√©no*</label>
                  <input type="text" class="form-control" name="jmeno" id="jmeno" placeholder="Jan" required>
                  <div class="invalid-feedback">
                    Pros√≠me, vypl≈àte va≈°e jm√©no.
                  </div>
                </div>
                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="P≈ô√≠jmen√≠" class="form-label"><i class="bi bi-person"></i> P≈ô√≠jmen√≠*</label>
                  <input type="text" class="form-control" name="prijmeni" id="prijmeni" placeholder="Nov√°k" required>
                  <div class="invalid-feedback">
                    Pros√≠me, vypl≈àte va≈°e p≈ô√≠jmen√≠.
                  </div>
                </div>



              </div>
              <div class="row">
                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="email" class="form-label"><i class="bi bi-envelope"></i> Email</label>
                  <input type="email" class="form-control no-validate" name="email" id="email" placeholder="vas@email.cz">
                  <div class="invalid-feedback">
                    Pros√≠me, vlo≈æte emailovou adresu, a≈• v√°s m≈Ø≈æeme kontaktovat.
                  </div>
                </div>

                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="telefon" class="form-label"><i class="bi bi-phone"></i> Telefon</label>
                  <input type="text" class="form-control no-validate" name="telefon" id="telefon" placeholder="+420 123 456 789">
                  <div class="invalid-feedback">
                    Pros√≠me, vlo≈æte v√°≈° telefon, a≈• v√°s m≈Ø≈æeme kontaktovat.
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="adresa" class="form-label"><i class="bi bi-house"></i> Adresa doruƒçen√≠*</label>
                  <input type="text" class="form-control" name="adresa" id="adresa" placeholder="Kvƒõtinkov√° 35, Plze≈à" required>
                  <div class="invalid-feedback">
                    Pros√≠me, vypl≈àte adresu nebo m√≠sto, kde v√°m p≈ôed√°me pot≈ôebn√© vybaven√≠.
                  </div>
                </div>

              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="poznamka" class="form-label"><i class="bi bi-pencil"></i> Pozn√°mka</label>
                  <textarea class="form-control no-validate" placeholder="Chcete n√°m je≈°tƒõ nƒõco dƒõlit?" name="poznamka" id="poznamka"></textarea>
                </div>
              </div>

              <hr class="my-4">
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="vec" class="form-label"><i class="bi bi-gift"></i> Co pot≈ôebujete*</label>
                  <input type="text" class="form-control" name="vec-1" id="vec-1"
                      placeholder="napi≈°te, co pot≈ôebujete" required>
                  <div class="invalid-feedback">
                    Napi≈°te, pros√≠m, alespo≈à jednu vƒõc, kterou od n√°s pot≈ôebujete zajistit.
                  </div>
                </div>
                <div id="dalsi-veci">
                </div>
              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <button type="button" class="btn btn-success" onclick="addRow()"><i class="bi bi-plus-circle"></i>
                      P≈ôidat
                      ≈ô√°dek</button>
                </div>
              </div>
              <hr class="my-4">
              <button class="w-100 btn btn-success btn-lg" type="button" onclick="send('requests-form')">Odeslat <i
                  class="bi bi-check2"></i></button>
            </form>
            <div class="alert alert-warning alert-dismissible fade collapse mt-3" id="requests-success">
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              <strong>V√°≈° po≈æadavek byl √∫spƒõ≈°nƒõ odesl√°n!</strong>
            </div>
          </div>




          <div class="m-3 tab-pane fade" id="nav-nabizim" role="tabpanel" aria-labelledby="nav-nabizim-tab">


            <form class="needs-validation" id="offers-form">
              <div class="row ">
                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="Jm√©no" class="form-label"><i class="bi bi-person"></i> Jm√©no*</label>
                  <input type="text" class="form-control" name="jmeno" id="jmeno" placeholder="Jan" required>
                  <div class="invalid-feedback">
                    Pros√≠me, vypl≈àte va≈°e jm√©no.
                  </div>
                </div>
                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="P≈ô√≠jmen√≠" class="form-label"><i class="bi bi-person"></i> P≈ô√≠jmen√≠*</label>
                  <input type="text" class="form-control" name="prijmeni" id="prijmeni" placeholder="Nov√°k" required>
                  <div class="invalid-feedback">
                    Pros√≠me, vypl≈àte va≈°e p≈ô√≠jmen√≠.
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="email" class="form-label"><i class="bi bi-envelope"></i> Email</label>
                  <input type="email" class="form-control no-validate" name="email" id="email" placeholder="vas@email.cz">
                  <div class="invalid-feedback">
                    Pros√≠me, vlo≈æte emailovou adresu, a≈• v√°s m≈Ø≈æeme kontaktovat.
                  </div>
                </div>

                <div class="col-md-6 col-sm-12 mb-3">
                  <label for="telefon" class="form-label"><i class="bi bi-phone"></i> Telefon*</label>
                  <input type="text" class="form-control no-validate" name="telefon" id="telefon" placeholder="+420 123 456 789" required>
                  <div class="invalid-feedback">
                    Pros√≠me, vlo≈æte v√°≈° telefon, a≈• v√°s m≈Ø≈æeme kontaktovat.
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="misto" class="form-label"><i class="bi bi-house"></i> M√≠sto p≈ôed√°n√≠</label>
                  <select class="form-select" aria-label="Default select example" name="misto" id="misto" required>
                    <option selected>Ups... tady chyb√≠ nƒõjak√© mo≈ænosti</option>
                  </select>
                  <div class="invalid-feedback">
                    Pros√≠me, vypl≈àte adresu nebo m√≠sto, kde v√°m p≈ôed√°me pot≈ôebn√© vybaven√≠.
                  </div>
                </div>

              </div>
              <div class="row">
                <div class="col-12 mb-3">
                  <label for="poznamka" class="form-label"><i class="bi bi-pencil"></i> Pozn√°mka</label>
                  <textarea class="form-control no-validate" placeholder="Chcete n√°m je≈°tƒõ nƒõco dƒõlit?" name="poznamka" id="poznamka"></textarea>
                </div>
              </div>

              <hr class="my-4">
              <div class="row">
                <div class="col-12 mb-3">
                  <table class="table" id="requests">
                    <thead>
                      <tr>
                        <th scope="col"><i class="bi bi-gift"></i> Nab√≠z√≠m n√°sleduj√≠c√≠ vybaven√≠</th>
                      </tr>
                    </thead>
                  </table>
                </div>
              </div>
              <button class="w-100 btn btn-success btn-lg" type="button" onclick="send('offers-form')">Odeslat <i
                  class="bi bi-check2"></i></button>
            </form>
            <div class="alert alert-warning alert-dismissible fade collapse mt-3" id="offers-success">
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              <strong>V√°≈° po≈æadavek byl √∫spƒõ≈°nƒõ odesl√°n!</strong>
            </div>

          </div>
        </div>


      </div>





      <div class="col-sm-10 offset-sm-1 pt-3">
        <div class="row">
          <div class="col-sm-12 col-md-12 text-center">
            <p class="text-muted pt-3"><small>Za podpory:</small></p>
            <div class="row">
              <div class="col-sm-12 py-3">
                <a href="https://www.skaut.cz" target="_blank" title="Skaut"><img
                    src="https://cdn.jsdelivr.net/gh/bbscout/daruj-potrebne@main/img/skaut.svg" class="img-fluid loga"
                    alt="Skaut"> </a>
              </div>


            </div>
          </div>

        </div>
      </div>
    </main>
  </div>
  <footer class="my-5 text-muted text-center text-small">
    <p class="mb-2"><small>V√°≈° prohl√≠≈æeƒç m≈Ø≈æe ukl√°dat tzv. <a href="https://cs.wikipedia.org/wiki/HTTP_cookie"
          class="link-secondary" target=_blank>cookies</a> soubory, nicm√©nƒõ tento web s nimi nijak aktivnƒõ
        nepracuje.</small></p>
    <p class="mb-1"><small>S üíôüíõ vytvo≈ôili <a href="https://ctverak.cz" target="_blank" class="link-secondary">Martin</a> a <a href="https://atelierkrejsa.cz" target="_blank" class="link-secondary">B≈ô√©≈•a</a> ¬© 2022</small></p>
  </footer>
  </div>
  <script>
    pocetVeci = 1;
    google.script.run.withSuccessHandler(showRequests).getRequests()
    google.script.run.withSuccessHandler(showPlaces).getPlaces();

     function showPlaces(data) {
      var template = `<option selected disabled value="">Vyberte m√≠sto p≈ôed√°n√≠</option>`;
      data.forEach((row, i) => {
        template += `<option>${row.adresa} (${row.otevreno})</option>`;
      })

      console.log(template);

      document.getElementById("misto").innerHTML = template;
     }

    function showRequests(data) {
      
      data = data.map((row, i) => {
      var template = `<tr>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="${row.id}" name="vec-offer-${i} id="vec-offer-${i}">
                            <span ${row.rezervace ? "style='text-decoration: line-through;'" : ""}>${row.vec}</span>
                          </div>
                        </td>
                      </tr>`;
        return template;
      }).join("\n");

      var el = document.createElement("tbody");
      el.innerHTML = data;
      document.getElementById("requests").appendChild(el);
    }
    
    function addRow() {
      pocetVeci++
      var newRow = `<input type="text" class="form-control no-validate" name="vec-${pocetVeci}" id="vec-${pocetVeci}" placeholder="napi≈°te, co pot≈ôebujete">`;
      var el = document.createElement("div");
      el.classList.add("col-12", "mb-3");
      el.innerHTML = newRow;
      document.getElementById("dalsi-veci").appendChild(el);
    }

    function send(formId) {
      var form = document.getElementById(formId);

      if(!form.checkValidity()) {
        form.classList.add('was-validated')
        return
      }
      var formData = new FormData(form);
      var data = [];
      var head = {};
      formData.forEach(function (value, key) {
        if(key.includes("vec-")) {
          if(value) {
            data.push(value);
          }
          } else {
          head[key] = value;
        }
      });

      data = data.map(item => {
        return Object.assign({}, head, {
          vec: item
        });
      })

      if (formId == "offers-form") {
        data = data.map(item => {
          item.nabidka = item.vec;
          delete item.vec;
          return item;
        })
      }
      
      
      console.log(data);

      if(formId == "requests-form") {
        google.script.run.withSuccessHandler(onSuccess('requests-success',form)).addRequest(data);
      } else if (formId == "offers-form") {
        google.script.run.withSuccessHandler(onSuccess('offers-success',form)).addOffer(data);
      }

      
    }

    function onSuccess(alertId,form) {
      form.classList.remove('was-validated');
      form.reset();
      document.getElementById('dalsi-veci').innerHTML = '';
      document.getElementById(alertId).classList.add('show');
    }
    

  </script>
</body>

</html>